<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>Intro to Python - Session 3</title>
    <meta charset="utf-8" />
    <meta name="author" content="http://rockefelleruniversity.github.io/Intro_To_Python/" />
    <meta name="author" content="brc@rockefeller.edu" />
    <script src="libs/header-attrs-2.30/header-attrs.js"></script>
    <link rel="stylesheet" href="default.css" type="text/css" />
    <link rel="stylesheet" href="metropolisCustom.css" type="text/css" />
    <link rel="stylesheet" href="metropolis-fontsCustom.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">
class: middle, inverse, title-slide

.title[
# Intro to Python - Session 3
]
.subtitle[
## <html><br />
<br />
<hr color='#EB811B' size=1px width=796px><br />
</html><br />
Bioinformatics Resource Center - Rockefeller University
]
.author[
### <a href="http://rockefelleruniversity.github.io/Intro_To_Python/" class="uri">http://rockefelleruniversity.github.io/Intro_To_Python/</a>
]
.author[
### <a href="mailto:brc@rockefeller.edu" class="email">brc@rockefeller.edu</a>
]

---







```
## Using virtual environment '/github/home/.virtualenvs/r-reticulate' ...
```

---
##  Data Visualization with Python

Today's goals:

- Introduce Python's utilities for data visualization
- Learn how to customize several types of plots for publication-worthy data visualizations
- Explore online documentation

---

## Workflow for Generating Figures

In general, the recipe for creating a figure is as follows:

1. Generate or import the data to be plotted. This is generally a list of x values and a list of y values.
2. Import matplotlib.pyplot to have access to the library and functions
3. Generate the figure and axes
4. Plot the data on the appropriate axis or axes using functions such as `plot()`, `scatter()`, `bar()`, etc..
5. Customize your plot using the built-in options for the function you used to plot (found in documentation).
6. Render your plot using `show()` and save or export it if you wish.


---

![Data visualization workflow](imgs/workflow.png)

---

## Matplotlib

Matplotlib is Python's library for visualization. It has extensive documentation available [online](https://matplotlib.org/stable/), including many [tutorials](https://matplotlib.org/stable/tutorials/index.html). Within Matplotlib, you will mostly be working with `pyplot` to generate simple plots. You can view the documentation for pyplot [here](https://matplotlib.org/stable/api/pyplot_summary.html#module-matplotlib.pyplot). Each function within pyplot has detailed descriptions of the arguments it takes - these will be very useful when you would like to customize your plots.


---

## Importing matplotlib.pyplot

To import matplotlib.pyplot, simply type `import matplotlib.pyplot as plt` at the top of your code. You can then refer to the library as `plt` in your code as needed. Note that this isn't strictly necessary, but you will find that this is an almost-universal naming convention (other libraries follow similar conventions too).



``` python
import matplotlib.pyplot as plt
```

---

## Figures, Plots, and Subplots

In Python, the best way to make a figure is by using the [`subplots()`](https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.subplots.html) function to define a figure and set(s) of axes. The reason we use the `subplots()` function is that it makes it easy to add multiple plots/axes to a figure, which is commonly done in the visualization of scientific data. To define a figure, you can write:


``` python
fig, ax = plt.subplots()
```

---

## The First Plot


``` python
fig, ax = plt.subplots()
```

![](Session3_files/figure-html/unnamed-chunk-6-1.png)&lt;!-- --&gt;

---

## A Closer Look


``` python
fig, ax = plt.subplots()
```

- `fig` is your figure (think: shape and size of your plot)
- `ax` is your set of axes where you will plot your data and customize how the plot looks
- You can have multiple axes in a single figure (which we will see later)  
- [`subplots()`](https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.subplots.html) is a function which has multiple arguments that you can use to specify the size and shape of your figure, as well as other parameters for your axes. 

Let's visit the [documentation](https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.subplots.html) and take a look at the options.

---

## Figure Size

- You can specify the size of the figure using the `figsize=([width], [height])` option (dimensions should be in inches based on default 100 dpi - may change depending on your monitor).
- At the bottom of your code, type `plt.show()` to render your plot


``` python
fig, ax = plt.subplots(figsize=(4, 3))
plt.show()
```

![](Session3_files/figure-html/unnamed-chunk-8-3.png)&lt;!-- --&gt;

---

## Axis Limits

- You can set the limits of your x and y axes by applying the set_xlim() or set_ylim() function to your axes, ax.


``` python
fig, ax = plt.subplots(figsize=(3, 2))
ax.set_xlim(-3, 4)
```

```
## (-3.0, 4.0)
```

``` python
plt.show()
```

![](Session3_files/figure-html/unnamed-chunk-9-5.png)&lt;!-- --&gt;


---
## Multiple Subplots

Looking at the [`subplots()`](https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.subplots.html) documentation again, we can see that we can specify the number and arrangement of subplots we want:

- `ncols` for the number of columns
- `nrows` for the number of rows

You can then define a corresponding axis for each subplot. Below is the code to generate two horizontally (`fig1`) and vertically (`fig2`) stacked subplots.


``` python
fig1, (ax1, ax2) = plt.subplots(nrows=1, ncols=2)

fig2, (ax3, ax4) = plt.subplots(nrows=2, ncols=1)
```


---
## Example with 4 Subplots

Let's make a 2x2 grid of subplots. Note that we use nested brackets to specify the positions of each subplot within the figure.


``` python
fig, ((ax_nw, ax_ne), (ax_sw, ax_se)) = plt.subplots(nrows=2, ncols=2)

plt.show()
```


---

## Arranging Subplots

![](imgs/4x4grid.png)


---
## Advanced Subplot Options

- Other [`subplots()`](https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.subplots.html) options:
  - `width_ratios` and `height_ratios`  to adjust the relative sizes of rows and columns 
  - `sharex` and `sharey` to force subplots to share an x or y axis 
- [`gridspec`](https://matplotlib.org/stable/users/explain/axes/arranging_axes.html) for arbitrary/custom subplots (ex: different number of plots in each row)

---

## Importing Data

Now that we can make figures and axes, let's grab some data to plot. We are going to use some patient data that contains sex ('Male' or 'Female'), weight (kg) and height (cm). We will then have 3 arrays of data to work with.


``` python
import numpy as np
sex, height, weight = np.genfromtxt('data/height-weight.csv', unpack = True, delimiter = ",", skip_header=True, dtype=None, encoding='UTF-8')
print(sex)
```

```
## ['Male' 'Male' 'Male' 'Male' 'Female' 'Female' 'Female' 'Female' 'Male'
##  'Male' 'Female' 'Female' 'Male' 'Female' 'Female' 'Male' 'Male' 'Male'
##  'Male' 'Male' 'Male' 'Female' 'Male' 'Female' 'Female' 'Male' 'Male'
##  'Male' 'Male' 'Male' 'Female' 'Male' 'Male' 'Female' 'Male' 'Female'
##  'Male' 'Female' 'Male' 'Female' 'Male' 'Female' 'Female' 'Female'
##  'Female' 'Female' 'Female' 'Female' 'Male' 'Female' 'Female' 'Female'
##  'Female' 'Female' 'Male' 'Female' 'Female' 'Female' 'Male' 'Male'
##  'Female' 'Male' 'Female' 'Male' 'Male' 'Female' 'Male' 'Female' 'Male'
##  'Female' 'Female' 'Male' 'Male' 'Female' 'Male' 'Female' 'Male' 'Male'
##  'Female' 'Female' 'Female' 'Female' 'Male' 'Female' 'Female' 'Female'
##  'Female' 'Male' 'Female' 'Male' 'Male' 'Male' 'Female' 'Male' 'Female'
##  'Female' 'Female' 'Female' 'Female' 'Female']
```

---

## Manipulating our Data

Let's separate our weight and height data by sex. Can you see what the code below does?


``` python
height_m = []
height_f = []
weight_m = []
weight_f = []

for i in range(len(sex)):
    if sex[i] == 'Male':
        height_m.append(height[i])
        weight_m.append(weight[i])
    else:
        height_f.append(height[i])
        weight_f.append(weight[i])
```

---
## Scatter Plots

Scatter plots are used for displaying discrete data points, where each point has a set of coordinates `\((x,y)\)`. If you want to plot data points `\((x_1, y_1), (x_2, y_2) ... (x_n, y_n)\)` from lists `\(x = (x_1, x_2,...,x_n)\)` and `\(y = (y_1, y_2,...,y_n)\)`, you can use the [`scatter()`](https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.scatter.html) function, applied to the axis you want to plot on.

Let's create a plot of height vs weight using our patient data. We are going to generate a 2x1 subplot and create a scatter plot on the left subplot.


``` python
# Generate figure and axes
fig, (ax1, ax2) = plt.subplots(ncols = 2, nrows = 1, figsize=(10, 4))

# Plot data on ax1
ax1.scatter(weight_m, height_m)
ax1.scatter(weight_f, height_f)

plt.show()
```

---

## Scatter Plots


``` python
# Generate figure and axes
fig, (ax1, ax2) = plt.subplots(ncols = 2, nrows = 1, figsize=(10, 4))

# Plot data on ax1
ax1.scatter(weight_m, height_m)
ax1.scatter(weight_f, height_f)

plt.show()
```

![](Session3_files/figure-html/unnamed-chunk-15-7.png)&lt;!-- --&gt;

---

## Customizing Scatter Plots

Take a look at the options in the [`scatter()`](https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.scatter.html) documentation. Some common parameters you could use to customize your scatter plot are:

- `s`: marker size in points ^2 (don't ask why...). 
- `color (c)`: marker color. Enter a string that could include a named color, RBG code, or hex color code. Find a full guide to specifying colors [here](https://matplotlib.org/stable/users/explain/colors/colors.html#colors-def).
- `marker`: marker style. Choose between a variety of preset options, the default being 'o' for circles. View the full list of options [here](https://matplotlib.org/stable/api/markers_api.html#module-matplotlib.markers).
- `linewidths`: width of the marker outline. Enter number in pts.
- `edgecolors`: color of the marker outline. Enter as a string, similar to the value of `c`.
- `alpha`: transparency (0 = transparent, 1 = opaque)

---

## Named Colors

Python has a number of [named colors](https://matplotlib.org/stable/gallery/color/named_colors.html). 

![Matplotlib named colors](imgs/named_colors.png)

---
## Named Colors

You can use these color names as strings to define colors within the parameters of scatter(), or you can also specify hex or RGB color codes as strings.


* Named colors: color = 'magenta'
* HEX: color = '#1D7308
* RGB: color = (0.1, 0.2, 0.5)


---
## Customize Your Plot

Using these colors and the list of parameters below, take a second to customize your plot of weight vs height.

- `s`: marker size in points ^2 (don't ask why...). 
- `color (c)`: marker color. Enter a string that could include a named color, RBG code, or hex color code. Find a full guide to specifying colors [here](https://matplotlib.org/stable/users/explain/colors/colors.html#colors-def).
- `marker`: marker style. Choose between a variety of preset options, the default being 'o' for circles. View the full list of options [here](https://matplotlib.org/stable/api/markers_api.html#module-matplotlib.markers).
- `linewidths`: width of the marker outline. Enter number in pts.
- `edgecolors`: color of the marker outline. Enter as a string, similar to the value of `c`.
- `alpha`: transparency (0 = transparent, 1 = opaque)

---

## Customized Plot


``` python
# Generate figure and axes
fig, (ax1, ax2) = plt.subplots(ncols = 2, nrows = 1, figsize=(10, 4))

# Plot data on ax1
ax1.scatter(weight_m, height_m, c = 'royalblue', alpha = 0.5, marker = 's')
ax1.scatter(weight_f, height_f, c = 'magenta', alpha = 0.5, marker = 'o')

plt.show()
```

![](Session3_files/figure-html/unnamed-chunk-16-9.png)&lt;!-- --&gt;

---

## Titles and Axis Labels

Let's add a title and some axis labels to our plot. To do this, we can use the following functions:


``` python
ax1.set_title("Height vs Weight")
ax1.set_xlabel("Weight (kg)")
ax1.set_ylabel("Height (cm)")
```

Be sure to add all of this code before the `plt.show()` line, which renders the plot. Anything after `show()` will not be applied to the figure you see.

---

## Add Your Labels


``` python
# Generate figure and axes
fig, (ax1, ax2) = plt.subplots(ncols = 2, nrows = 1, figsize=(10, 4))

# Plot data on ax1
ax1.scatter(weight_m, height_m, c = 'royalblue', alpha = 0.5, marker = 's')
ax1.scatter(weight_f, height_f, c = 'magenta', alpha = 0.5, marker = 'o')

ax1.set_title("Height vs Weight")
ax1.set_xlabel("Weight (kg)")
ax1.set_ylabel("Height (cm)")

plt.show()
```

---

## Resulting Plot

![](Session3_files/figure-html/unnamed-chunk-19-11.png)&lt;!-- --&gt;

---
## Histograms 

Another common plot type is a histogram. We are going to put a histogram of height distributions by sex in the blank subplot. We will do this using the `plt.hist()` function. You can find the documentation [here](https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.hist.html).

At a minimum, `hist()` requires the data points you wish to plot as an argument. You may also specify the `bins` argument as an integer (the default is 10).

Let's take our previous plot and add histograms for the male and female height distributions to the subplot axes on the right, each with 5 bins. Also, add a title and axis labels for the histogram. Note: You may have to change the `figsize` parameter so that the labels all fit.

---
## Histograms 


``` python
ax2.hist(height_m, bins=5, color = 'royalblue', alpha = 0.5)
ax2.hist(height_f, bins=5, color = 'magenta', alpha = 0.5)


ax2.set_title('Height Distributions by Sex')
ax2.set_ylabel('Count')
ax2.set_xlabel('Height (cm)')
```

---
## Histograms 

![](Session3_files/figure-html/unnamed-chunk-21-13.png)&lt;!-- --&gt;

---

## Legends

We can add a legend to a set of axes by using the legend() function. You can find the documentation here.

We automatically generate a legend by adding a parameter called label as a string in each plot we would like to include in the legend, and then calling the legend() function.

You can pass arguments to this function to specify the formatting and location of the legend, but we'll skip that part today. Check out the documentation for full details!

In the box below, add a legend for each set of axes. 

---
## Legends



``` python
# Add legend
ax1.legend()
ax2.legend()
```

---
## Legends


![](Session3_files/figure-html/unnamed-chunk-23-15.png)&lt;!-- --&gt;

---
## Line Plots

Another common plot is a line plot. This uses the `plot()` function from `matplotlib.pyplot` (check out the documentation [here](https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.plot.html)). The minimum arguments for `plot()` are the x- and y-coordinates to be plotted, which will be output with a line connecting them. Let's plot the function `\(y = x^2\)`.

The first thing we need to do is to define the list of coordinates to be plotted. Remember that even though the function we are plotting is continuous mathematically, we will still be plotting a discrete line of points. In the bow below:

1. Define the list of x-values using `numpy`'s `linspace()` function to create a list of 100 points between 0 and 2. 
2. Define a function `\(f(x) = x^2\)` 
3. Use it to generate a list of y-values. 

---
## Line Plots


``` python

x_values = np.linspace(0, 2, 100)

def f(x):
    return x**2

y_values = f(x_values)
```

---
## Line Plots

Next, plot your function on the a fresh set of axes. Add any labels and other customizations you would like.


``` python
fig, ax = plt.subplots()

ax.plot(x_values, y_values, c = 'teal', linestyle = '--')

ax.set_title("Quadratic Function $y = x^2$")
ax.set_xlabel("x")
ax.set_ylabel("y")

plt.show()
```

![](Session3_files/figure-html/unnamed-chunk-25-17.png)&lt;!-- --&gt;
    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
  "highlightStyle": "github",
  "highlightLines": true,
  "countIncrementalSlides": false
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
// add `data-at-shortcutkeys` attribute to <body> to resolve conflicts with JAWS
// screen reader (see PR #262)
(function(d) {
  let res = {};
  d.querySelectorAll('.remark-help-content table tr').forEach(tr => {
    const t = tr.querySelector('td:nth-child(2)').innerText;
    tr.querySelectorAll('td:first-child .key').forEach(key => {
      const k = key.innerText;
      if (/^[a-z]$/.test(k)) res[k] = t;  // must be a single letter (key)
    });
  });
  d.body.setAttribute('data-at-shortcutkeys', JSON.stringify(res));
})(document);
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
