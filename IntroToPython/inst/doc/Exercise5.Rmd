---
title: "Exercise 5"
author: "Rockefeller University, Bioinformatics Resource Centre"
date: "https://rockefelleruniversity.github.io/Intro_To_Python/"
output: 
  html_document:
    number_sections: false  ## if you want number sections at each table header
    theme: united  # many options for theme, this one is my favorite.
    highlight: tango  # specifies the syntax highlighting style
params:
  toMessage: false    
---

```{r, setup,include=FALSE}
toMessage <- ifelse(!is.null(params$toMessage),params$toMessage,FALSE)
message(toMessage)
```


<p>&nbsp;</p>
These exercises are about logical operators and reading/writing and scripts from [Session 2](https://rockefelleruniversity.github.io/Intro_To_Python/). 


**Exercise 1** - **Reading/Writing**

- Read in the tab delimited file "GeneExpression.txt". (Hint: The delimiter for a tab file is "\t".)
```{python,echo=toMessage}
import numpy as np

geneExpression = np.genfromtxt("data/GeneExpression.txt", delimiter="\t", skip_header=True)

```

- Read in the tab delimited file "GeneExpressionWithMethods.txt". This file contains information on analysis steps used to produce file. We will want to skip those. 
*Hint: Check the `skip_header` argument in the help page*

```{python,echo=toMessage}

geneExpression = np.genfromtxt("data/GeneExpressionWithMethods.txt", delimiter="\t", skip_header=4)

geneExpression
```

- Find the mean expression across rows. (Hint: NumPy objects have a mean function attribute)

```{python,echo=toMessage}

geneExpression[0,].mean()
geneExpression[1,].mean()
geneExpression[2,].mean()
geneExpression[3,].mean()
geneExpression[4,].mean()
geneExpression[5,].mean()
geneExpression[6,].mean()
geneExpression[7,].mean()

# Alternatively we could use the axis argument.
geneExpression.mean(axis=1)
```

- The corresponding gene names are stored in "GeneNames.txt". Read this in and subset it based on whether the mean gene expression is over 6. Write this out into a new text file. 

```{python,echo=toMessage}

sub_idx = geneExpression.mean(axis=1) > 6
geneNames = np.genfromtxt("data/GeneNames.txt", delimiter="\t", dtype="U6")
geneNames_sub = geneNames[sub_idx]
np.savetxt("GeneNames_highexpression.txt", geneNames_sub, delimiter="\t", fmt='%s')
```


